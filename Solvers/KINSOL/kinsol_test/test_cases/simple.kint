# First Test case for Kinsol tester

THREAD SIMPLE
	ROUTINE SETSIZE
		NVAR = 2;
		NEQ = 2;
	END 

	ROUTINE SETGUESS
		for (int i = 0; i < NVAR; i++)
		{
			guess[i] = 0.1;
		}
	END 

	ROUTINE SETOPTIONS
		options->GlobalStrategy = 0;
		options->LinearSolver = "KINDENSE";
		options->FuncNormTolerance = 1.e-5;
		options->ScaledStepTol = 1.e-5;
		options->MaxSetupCalls = 1;
		options->if_jacobian = 1;
		options->finalstatsPrintLevel = 2;
	END 
	
	ROUTINE RESFUNC
		r[0] = x[0] * x[1] + 2 * x[0] + 3.0;
		r[1] = (x[1] + x[0])*(x[1] - x[0]) + 72.9;
	END 

	ROUTINE JACFUNC
		adouble ax[2];
		adouble ay[2];
		double oy[2];

		trace_on(1);
		ax[0] <<= x[0];
		ax[1] <<= x[1];

		ay[0] = ax[0] * ax[1] + 2 * ax[0] + 3.0;
		ay[1] = (ax[1] + ax[0])*(ax[1] - ax[0]) + 72.9;

		ay[0] >>= oy[0];
		ay[1] >>= oy[1];
		trace_off();

		jacobian(1, 2, 2, x, J);
	END 

	ROUTINE INFO
		
	END
		
	ROUTINE ERR

	END

END  










